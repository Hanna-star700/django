{% extends 'base.html' %}

{% block title %}–í—Ö—ñ–¥ / –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è{% endblock %}

{% block content %}
<div class="page-header">
    <h1>üë§ –í—Ö—ñ–¥ –∞–±–æ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—è</h1>
    <p>–£–≤—ñ–π–¥—ñ—Ç—å —É —Å–≤—ñ–π –∞–∫–∞—É–Ω—Ç –∞–±–æ —Å—Ç–≤–æ—Ä—ñ—Ç—å –Ω–æ–≤–∏–π –¥–ª—è –¥–æ—Å—Ç—É–ø—É –¥–æ –≤—ñ–¥–µ–æ —É—Ä–æ–∫—ñ–≤</p>
</div>

<div class="card" style="max-width: 500px; margin: 0 auto;">
  <!-- –¢–∞–±—ã -->
  <div style="display: flex; border-bottom: 2px solid #e9ecef; margin-bottom: 2rem;">
    <button class="auth-tab active" onclick="switchTab('login')" id="loginTab" style="flex: 1; padding: 1rem; background: none; border: none; border-bottom: 3px solid #667eea; cursor: pointer; font-size: 1.1rem; font-weight: 600; color: #667eea; transition: all 0.3s;">
      üîê –í—Ö—ñ–¥
    </button>
    <button class="auth-tab" onclick="switchTab('register')" id="registerTab" style="flex: 1; padding: 1rem; background: none; border: none; border-bottom: 3px solid transparent; cursor: pointer; font-size: 1.1rem; font-weight: 600; color: #999; transition: all 0.3s;">
      üÜï –†–µ—î—Å—Ç—Ä–∞—Ü—ñ—è
    </button>
  </div>

  <!-- –§–æ—Ä–º–∞ –≤—Ö–æ–¥—É -->
  <div id="loginForm" class="auth-form">
    <form method="post" autocomplete="on">
      {% csrf_token %}
      <input type="hidden" name="form_type" value="login" />
      <div class="form-group">
        <label for="id_username" class="form-label">üë§ –Ü–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞</label>
        {{ login_form.username }}
      </div>
      <div class="form-group">
        <label for="id_password" class="form-label">üîí –ü–∞—Ä–æ–ª—å</label>
        {{ login_form.password }}
      </div>
      <button type="submit" class="btn btn-full" style="margin-top: 1.5rem;">–£–≤—ñ–π—Ç–∏</button>
      {% if login_form.errors %}
      <div class="form-errors" style="margin-top:1rem;">
        <div class="error-icon">‚ö†Ô∏è</div>
        <div class="error-content">
          <h4>–ü–æ–º–∏–ª–∫–∞ –≤—Ö–æ–¥—É:</h4>
          <ul>
            {% for field, errors in login_form.errors.items %}
              {% for error in errors %}
                <li>{{ error }}</li>
              {% endfor %}
            {% endfor %}
            {% for error in login_form.non_field_errors %}
              <li>{{ error }}</li>
            {% endfor %}
          </ul>
        </div>
      </div>
      {% endif %}
    </form>
  </div>

  <!-- –§–æ—Ä–º–∞ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó -->
  <div id="registerForm" class="auth-form" style="display: none;">
    <form method="post" autocomplete="on">
      {% csrf_token %}
      <input type="hidden" name="form_type" value="register" />
      <div class="form-group">
        <label for="register_username" class="form-label">üë§ –Ü–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞</label>
        {{ register_form.username }}
        <div class="form-help">–û–±–µ—Ä—ñ—Ç—å —É–Ω—ñ–∫–∞–ª—å–Ω–µ —ñ–º'—è –∫–æ—Ä–∏—Å—Ç—É–≤–∞—á–∞</div>
      </div>
      <div class="form-group">
        <label for="register_password1" class="form-label">üîí –ü–∞—Ä–æ–ª—å</label>
        {{ register_form.password1 }}
        <div class="form-help">–ú—ñ–Ω—ñ–º—É–º 8 —Å–∏–º–≤–æ–ª—ñ–≤</div>
      </div>
      <div class="form-group">
        <label for="register_password2" class="form-label">üîí –ü—ñ–¥—Ç–≤–µ—Ä–¥–∂–µ–Ω–Ω—è –ø–∞—Ä–æ–ª—é</label>
        {{ register_form.password2 }}
      </div>
      <button type="submit" class="btn btn-full" style="margin-top: 1.5rem;">–°—Ç–≤–æ—Ä–∏—Ç–∏ –∞–∫–∞—É–Ω—Ç</button>
      {% if register_form.errors %}
      <div class="form-errors" style="margin-top:1rem;">
        <div class="error-icon">‚ö†Ô∏è</div>
        <div class="error-content">
          <h4>–ü–æ–º–∏–ª–∫–∏ –≤ —Ñ–æ—Ä–º—ñ:</h4>
          <ul>
            {% for field, errors in register_form.errors.items %}
              {% for error in errors %}
                <li>{{ error }}</li>
              {% endfor %}
            {% endfor %}
            {% for error in register_form.non_field_errors %}
              <li>{{ error }}</li>
            {% endfor %}
          </ul>
        </div>
      </div>
      {% endif %}
    </form>
  </div>

  <div style="text-align: center; margin-top: 2rem; padding-top: 2rem; border-top: 1px solid #e9ecef;">
    <p style="color: #666; margin: 0;">
      –ê–±–æ –ø—Ä–æ–¥–æ–≤–∂–∏—Ç–∏ –±–µ–∑ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó: <a href="{% url 'quiz' %}" style="color: #667eea; font-weight: 600;">–ü—Ä–æ–π—Ç–∏ –≤—Å—Ç—É–ø–Ω–∏–π —Ç–µ—Å—Ç</a>
    </p>
  </div>
</div>

<script>
function switchTab(tab) {
  const loginTab = document.getElementById('loginTab');
  const registerTab = document.getElementById('registerTab');
  const loginForm = document.getElementById('loginForm');
  const registerForm = document.getElementById('registerForm');
  
  if (tab === 'login') {
    loginTab.style.borderBottom = '3px solid #667eea';
    loginTab.style.color = '#667eea';
    registerTab.style.borderBottom = '3px solid transparent';
    registerTab.style.color = '#999';
    loginForm.style.display = 'block';
    registerForm.style.display = 'none';
  } else {
    registerTab.style.borderBottom = '3px solid #667eea';
    registerTab.style.color = '#667eea';
    loginTab.style.borderBottom = '3px solid transparent';
    loginTab.style.color = '#999';
    registerForm.style.display = 'block';
    loginForm.style.display = 'none';
  }
}

// –ê–≤—Ç–æ–º–∞—Ç–∏—á–Ω–æ –≤—ñ–¥–∫—Ä–∏—Ç–∏ —Ç–∞–± —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó —è–∫—â–æ —î –ø–æ–º–∏–ª–∫–∏ –≤ —Ñ–æ—Ä–º—ñ —Ä–µ—î—Å—Ç—Ä–∞—Ü—ñ—ó –∞–±–æ —è–∫—â–æ –ø–µ—Ä–µ–¥–∞–Ω–æ –ø–∞—Ä–∞–º–µ—Ç—Ä
{% if register_form.errors or show_register %}
  switchTab('register');
{% endif %}
</script>
{% endblock %}
